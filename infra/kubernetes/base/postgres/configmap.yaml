apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-config
data:
  custom-postgresql.conf: |
    # Memory (tuned for ~4GB allocation)
    shared_buffers = 1GB
    effective_cache_size = 3GB
    work_mem = 16MB
    maintenance_work_mem = 256MB

    # WAL
    wal_buffers = 32MB
    max_wal_size = 2GB
    min_wal_size = 512MB

    # Connections
    max_connections = 100

    # Query planner
    random_page_cost = 1.1
    effective_io_concurrency = 200

    # Logging
    log_min_duration_statement = 1000
    log_checkpoints = on
    log_connections = on
    log_disconnections = on
